\documentclass[12pt]{article}
\usepackage{geometry}
\geometry{
a4paper,
total={170mm,257mm},
left=20mm,
top=20mm,
headheight=12pt
}
\usepackage[parfill]{parskip} % Activate to begin paragraphs with an empty line rather than an indent
\usepackage{graphicx} % Use pdf, png, jpg, or epsÂ§ with pdflatex; use eps in DVI mode
% TeX will automatically convert eps --> pdf in pdflatex
		
\usepackage{amssymb,amsmath,amsthm}
\usepackage{commath}
\usepackage{longtable}
\usepackage[hyphens]{url}
\usepackage[dvipsnames]{xcolor}
\usepackage[unicode=true,colorlinks=true,urlcolor=CadetBlue,citecolor=black,linkcolor=black]{hyperref}
\usepackage{booktabs}
\usepackage{pgfplotstable} % http://mirrors.ctan.org/graphics/pgf/contrib/pgfplots/doc/pgfplotstable.pdf
\PassOptionsToPackage{hyphens}{url} % url is loaded by hyperref
\usepackage{authblk}
\usepackage{subcaption}
\captionsetup[subfigure]{labelformat=empty}
\usepackage[font=small,labelfont=bf]{caption}
\usepackage{longtable}
\usepackage{gensymb}
\usepackage{cleveref}

%SetFonts
% newtxtext+newtxmath
\usepackage{newtxtext} %loads helv for ss, txtt for tt
\usepackage{amsmath}
\usepackage[bigdelims]{newtxmath}
\usepackage[T1]{fontenc}
\usepackage{textcomp}
%SetFonts

\renewcommand{\baselinestretch}{1.5}

% less space before sections 
% \@startsection {NAME}{LEVEL}{INDENT}{BEFORESKIP}{AFTERSKIP}{STYLE} 
%            optional * [ALTHEADING]{HEADING} 
\makeatletter
 \renewcommand\section{\@startsection {section}{1}{\z@}%
     {-2.5ex \@plus -1ex \@minus -.2ex}%
     {1.3ex \@plus.2ex}%
    {\Large\bfseries}}
    
% Species names
%% Meta-Command for defining new species macros
\usepackage{xspace}

\newcommand{\species}[3]{%
  \newcommand{#1}{\gdef#1{\textit{#3}\xspace}\textit{#2}\xspace}}
  
\species{\yeast}{Saccharomyces cerevisiae}{S.~cerevisiae}
\species{\calbicans}{Candida albicans}{C.~albicans}
\species{\cneoformans}{Cryptococcus neoformans}{C.~neoformans}

% Yoav & Lee commands
\newcommand*{\tr}{^\intercal}
\let\vec\mathbf
\newcommand{\matrx}[1]{{\left[ \stackrel{}{#1}\right]}}
\newcommand{\diag}[1]{\mbox{diag}\matrx{#1}}
\newcommand{\goesto}{\rightarrow}
\newcommand{\dspfrac}[2]{\frac{\displaystyle #1}{\displaystyle #2} }
\newtheorem{theorem}{Theorem}
\newtheorem{corollary}{Corollary}
\newtheorem{lemma}{Lemma}
\newtheorem{remark}{Remark}
\newtheorem{result}{Result}
\renewcommand\qedsymbol{} % no square at end of proof
\newcommand{\cl}{\mathbf{L}}
\newcommand{\cj}{\mathbf{J}}
\newcommand{\ci}{I}
\newcommand{\likelihood}{\mathcal{L}}

% line numbers
 \usepackage[displaymath, mathlines]{lineno}
 \renewcommand\linenumberfont{\normalfont\small\sffamily}
\linenumbers
\modulolinenumbers[2]

% genotype commands
\newcommand{\euwt}{\emph{$2n$}}
\newcommand{\anwt}{\emph{$2n+1$}}
\newcommand{\eumt}{\emph{$2n^*$}}
\newcommand{\eumtM}{\emph{$2n^*_M$}}
\newcommand{\eumtA}{\emph{$2n^*_A$}}
\newcommand{\anmt}{\emph{$2n+1^*$}}

% Supplementary
\newcommand{\beginsupplement}{%
      	\setcounter{table}{0}
        \renewcommand{\thetable}{S\arabic{table}}%
        \setcounter{figure}{0}
        \renewcommand{\thefigure}{S\arabic{figure}}%
}

% NatBib
\usepackage[round,colon,authoryear]{natbib}

% Title page
\title{Aneuploidy can be an evolutionary diversion\\ on the path to adaptation}

% Authors
\renewcommand\Affilfont{\small}

\author[a,b,1]{Ilia Kohanovski}
\author[a,1]{Martin Pontz}
\author[c]{P\'{e}tra Vande Zande}
\author[c]{Anna Selmecki}
\author[d]{Orna Dahan}
\author[d]{Yitzhak Pilpel}
\author[e]{Avihu H. Yona}
\author[a,*]{Yoav Ram}

\affil[a]{School of Zoology, Faculty of Life Sciences, Tel Aviv University, Tel Aviv, Israel}
\affil[b]{School of Computer Science, Reichman University, Herzliya, Israel}
\affil[c]{Department of Microbiology and Immunology, University of Minnesota Medical School, Minneapolis, MN}
\affil[d]{Department of Molecular Genetics, Weizmann Institute of Science, Rehovot, Israel}
\affil[e]{Institute of Biochemistry, Food Science and Nutrition, Robert H. Smith Faculty of Agriculture, Food and Environment, The Hebrew University of Jerusalem, Israel}
\affil[1]{These authors contributed equally to this work}
\affil[*]{Corresponding author: yoav@yoavram.com}

% Document
\begin{document}
\maketitle

Classifications. Biological Sciences: Evolution, Genetics, Microbiology, Population Biology.

Keywords: whole-chromosome duplication, evolutionary model, adaptive evolution

\pagebreak

% Abstract 250 words
\begin{abstract} 
Aneuploidy is common in eukaryotes, often leading to decreased fitness. However, evidence from fungi and human tumur cells suggests that specific aneuploidies can be beneficial under stressful conditions and facilitate adaptation.
In a previous evolutionary experiment with yeast, populations evolving under heat stress became aneuploid, only to later revert to euploidy after beneficial mutations accumulated. It was therefore suggested that aneuploidy is a ``stepping stone'' on the path to adaptation.
Here, we test this hypothesis. We use Bayesian inference to fit an evolutionary model with both aneuploidy and mutation to the experimental results. We then predict the genotype frequency dynamics during the experiment, demonstrating that most of the evolved euploid population likely did not descend from aneuploid cells, but rather from the euploid wild-type population.
Our model shows how the beneficial mutation supply--the product of population size and beneficial mutation rate--determines the evolutionary dynamics: with low supply, much of the evolved population descends from aneuploid cells; but with high supply, beneficial mutations are generated fast enough to outcompete aneuploidy due to its inherent fitness cost.
Our results suggest that despite its potential fitness benefits under stress, aneuploidy can be an evolutionary ``diversion'' rather than a ``stepping stone'': it can delay, rather than facilitate, the adaptation of the population, and cells that become aneuploid may leave less descendants compared to cells that remain diploid.
\end{abstract}


\pagebreak 

% Introduction
\section*{Introduction}

%\paragraph{Aneuploidy is common in eukaryotes.}
Aneuploidy is an imbalance in the number of chromosomes in the cell: an incorrect karyotype.
Evidence suggests aneuploidy is very common in eukaryotes, e.g. animals~\citep{Santaguida2015review, Naylor2016, Bakhoum2017}, and fungi~\citep{Pavelka2010, Zhu2016, Robbins2017, Todd2017}.
Aneuploidy has been implicated in cancer formation, progression, and drug resistance~\citep{Boveri2008, Schvartzman2010, Santaguida2015review, Rutledge2016, Ippolito2021b, Lukow2021}.
It is also common in protozoan pathogens of the Leishmania genus, a major global health concern~\citep{Mannaert2012}, and contributes to the emergence of drug resistance~\citep{Selmecki2009} and virulence~\citep{Moller2018} in fungal pathogens, which are under-studied~\citep{Rodrigues2018}, despite infecting a billion people per year, causing significant morbidity in >150 million and death in >1.5 million people per year~\citep{Selmecki2009, Rodrigues2018}.

%\paragraph{Aneuploidy is generally deleterious.}
Experiments with human and mouse embryos found that most germ-line aneuploidies are lethal.
Aneuploidies are also associated with developmental defects and lethality in other multicellular organisms~\citep{Sheltzer2011}. % trisomy 21 and Klinefelter and Turner's syndromes
For example, aneuploid mouse embryonic cells grow slower than euploid cells~\citep{Williams2008}.
Similarly, in unicellular eukaryotes growing in benign conditions, aneuploidy usually leads to slower growth and decreased overall fitness, in part due to proteotoxic stress due to increased expression, gene dosage imbalance, and hypo-osmotic-like stress~\citep{Niwa2006, Torres2007, Pavelka2010, Sheltzer2011, Santaguida2015, Kasuga2016, Zhu2018, Tsai2019, Yang2021, Robinson2023}.

%\paragraph{Aneuploidy can lead to adaptation.}
However, aneuploidy can be beneficial under stressful conditions due to the wide range of phenotypes it can produce, some of which are advantageous~\citep{Pavelka2010, Yang2021}.
Indeed, in a survey of 1,011 yeast strains, aneuploidy has been detected in about 19\% \citep{Peter2018}.
Thus, aneuploidy can lead to rapid adaptation in unicellular eukaryotes~\citep{Gerstein2015,Torres2010, Hong2014, Rancati2008}, as well as to rapid growth of somatic tumour cells~\citep{Schvartzman2010, Sheltzer2017}.
For example, aneuploidy in \yeast facilitates adaptation to a variety of stressful conditions like heat and pH~\citep{Yona2012}, copper~\citep{Covo2014, Gerstein2015}, salt~\citep{Dhar2011, Robinson2023}, and nutrient limitation~\citep{Dunham2002, Gresham2008, Avecilla2022}, with similar results in \calbicans~\citep{Yang2021}.
Importantly, aneuploidy can also lead to drug resistance in pathogenic fungi such as \calbicans~\citep{Selmecki2008, Selmecki2010, Gerstein2020} and \cneoformans~\citep{Sionov2010}, which cause candidiasis and meningoencephalitis, respectively.
Although we focus here on aneuploidy, a similar phenomena of adaptation via gene duplication or amplification has been observed in yeast \citep{Lauer2018}, bacteria \citep{Sonti1989}, and DNA viruses \citep{Elde2012}.

%\paragraph{Transient adaptive solution.} 
\citet{Yona2012} demonstrated experimentally the importance of aneuploidy in adaptive evolution. They evolved populations of \yeast under strong heat stress.
The populations adapted to the heat stress within 450 generations, and this adaptation was determined to be due a duplication of Chromosome~III.
Later on, after more than 1,500 generations, the populations reverted back to an euploid state, while remaining adapted to the heat stress. 
Aneuploidy was therefore suggested to be a transient adaptive solution, because it can rapidly appear and take over the population under stressful conditions, and can then be rapidly lost when the cost of aneuploidy outweighs its benefit---after the stress is removed, or after refined beneficial mutations appear and fix~\citep{Yona2012}.
Furthermore, it has been suggested that aneuploidy is an evolutionary ``stepping stone'' that facilitates future adaptation by genetic mutations, which require more time to evolve~\citep{Yona2012,Yona2015}.

%\paragraph{The present study.}
Here, we test the hypothesis that aneuploidy is an evolutionary ``stepping stone'' that facilitates adaptive evolution by genetic mutations~\citep{Yona2012}.
We develop an evolutionary genetic model and fit it to the experimental results of \citet{Yona2012} to predict the genotype frequency dynamics in the experimental populations, thereby estimating the frequency of evolved euploid cells that descended from aneuploid cells. 
Our results show that although aneuploidy reached high frequencies in the experimental populations, the majority of cells in the evolved euploid population likely did not descend from aneuploid cells, but rather directly from wild-type euploid cells.
These suggests that at the lineage level, aneuploidy may be an ``evolutionary diversion'', rather than a ``stepping stone'', on the path to adaptation.


%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Results
\section*{Results}
In the heat-stress experiment of \citet{Yona2012}, four populations of \yeast evolved under 39\degree C.
Aneuploidy reached high frequency (>95\%) in all four experimental repetitions in the first 450 generations.
Two of the repetitions, marked $H2$ and $H4$, carried no large-scale duplications other than a Chromosome III trisomy.
These two repetitions continued to evolve under the same conditions, wherein aneuploidy was eliminated by generation 1,700 and 2,350 in $H4$ and $H2$, respectively.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Evolutionary genetic model.} 
To explore the dynamics during the evolutionary experiments, we developed an evolutionary genetic model, fitted the model to empirical data, and used it to predict the genotype frequency dynamics, or specifically, the fraction of the evolved euploid population descended from aneuploid cells. 

The model includes the effects of natural selection, genetic drift, aneuploidy, and mutation (i.e., other genetic variants), and follows a population of cells characterized by their genotype: 
euploid wild-type, \euwt, is the ancestral diploid genotype; 
euploid mutant, \eumt, has a diploid karyotype and a single beneficial mutation; 
aneuploid wild-type, \anwt, has an extra chromosome due to a chromosome duplication event; and
aneuploid mutant, \anmt, has and extra chromosome (like \anwt) and a beneficial mutation (like \eumt).
Note that `mutation' here refers to point mutations and other genetic variants unrelated to aneuploidy.
Fitness values of the different genotypes are denoted by $w_{\euwt}$, $w_{\eumt}$, $w_{\anwt}$, and $w_{\anmt}$, and the rate of mutation and aneuploidy are denoted by $\mu$ and $\delta$, respectively.
See \Cref{fig:models} for an illustration of the model.

We fitted this model to the experimental results\citep{Yona2012}--time for fixation (frequency >95\%) and for loss (frequency <5\%) of aneuploidy--using approximate Bayesian computation with sequential Monte Carlo (ABC-SMC)~\citep{Sisson2009}, thereby inferring the model parameters: rates of aneuploidy (i.e., mis-segregation, non-disjunction) and mutation and the fitness of all genotypes.
We then sampled posterior predictions for the genotype frequency dynamics using the estimated parameter values and compared different versions of the model to test additional hypotheses about the evolutionary process.


%%%%%%%% Fig illustration
\begin{figure}[h]
  \centering
    \includegraphics[width=0.7\textwidth]{model_illustration.pdf}      
  \caption{
    \textbf{Model Illustration.}
    There are four genotypes in our model: euploid wild-type, \euwt; euploid mutant, \eumt; aneuploid wild-type, \anwt; and aneuploid mutant, \anmt.
    Overall there are two possible trajectories from \euwt\; to \eumt.
    Arrows denote transitions between genotypes, with transitions rates $\mu$ for the beneficial mutation rate and $\delta$ for the aneuploidy rate.
    Elevation differences illustrate the expected, rather than the assumed, fitness differences between the genotypes.
   }
  \label{fig:models}
\end{figure}

%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Estimated rates and fitness effects of aneuploidy and mutation.} 
We inferred the posterior distribution of model parameters~(\Cref{fig:posterior}). 
We report parameter estimates using the MAP (maximum a posteriori) and providing the 50\% HDI (highest density interval) in square brackets. See Supplementary Material for sensitivity analysis.
%% estimates generated by MAP-and-hdi.ipynb

% without back transitions:
The estimated beneficial mutation rate is $\mu=2.965\cdot10^{-6}\ [2.718\cdot10^{-7}-3.589\cdot10^{-6}]$ per genome per generation (that is, roughly 3 out of $10^6$ cell divisions produce a mutant cell with a fitness advantage).
From the literature, the mutation rate per base pair is roughly $2-3\cdot10^{-10}$~\citep{Zhu2014,Lynch2008}, but it may be higher under heat stress, as several stresses~\citep{Heidenreich2007}, including heat \citep{Huang2018}, may cause hypermutation in yeast.
If we assume a 10-fold increase over the mutation rate reported in the literature, then the estimated beneficial mutation rate can be explained by a genomic target size of 1,000 base pairs (that is, 1,000 base pairs across the genome in which a mutation would provide a fitness advantage): $3\cdot10^{-10} \times 10 \times 1,000=3\cdot10^{-6}$.
Supporting this, \citet{Jarolim2013} found 279 genes that contributed to survival after a sudden shift from 30\degree C to 50\degree C, and \citet{Flynn2020} used a deep mutational scan of a single protein, Hsp90, to find 465 amino-acid variants (out of 14,160) that significantly increased growth rate in 37\degree C.
Furthermore, \citet{Yona2012} found at least 10 genes on Chromosome III that increased heat tolerance when over-expressed.
Assuming that other chromosomes also have a similar number of heat-tolerance genes (and even more, as Chromosome III is one of the smallest chromosomes~\citep{Gilchrist2019}), we estimate a total of 160 heat-tolerance genes in the genome.
Indeed, mutations were found in 97 genes in an evolutionary experiment with yeast under heat stress~\citep{Huang2018}.
Thus, to get a genomic target size of 1,000, it is enough that the average gene target size (number of base pairs in a gene in which a mutation is beneficial) is 6.25 base pairs. For example, \citet{Kohn2014} found a target size of 11 in a proton exporter gene (\emph{PMA1}) that contributes to high-salt adaptation.

The estimated rate of aneuploidy (i.e., mis-segregation, non-disjunction), $\delta=1.72\cdot10^{-3}\ [1.47\cdot10^{-3}-2.786\cdot10^{-3}]$ is higher than in previous studies: for Chromosome III in diploid \yeast, \citet{Zhu2014} estimated $6.7\cdot10^{-6}$ chromosome gain events per generation, and \citet{Kumaran2013} estimate $3.0\cdot10^{-5}-4.3\cdot10^{-5}$ chromosome loss events per generation (95\% confidence interval). 
However, this difference may be partly explained by an increased rate of aneuploidy during heat stress: heat shock can increase the rate of chromosome fragment loss by 2-3 orders of magnitude~\citep{Chen2012a}.

The estimated fitness values are $w_{\anwt}=1.022\ [1.021-1.023]$,
$w_{\anmt}=1.025\ [1.024-1.026]$,
$w_{\eumt}=1.028\ [1.026-1.029]$, all relative to the fitness of \euwt, which is set to $w_{\euwt}=1$. 
If we allow for transitions (mutation, chromosome loss and gain) to less-fit genotypes (e.g., \eumt\ to \anmt), then we infer similar but slightly different values, see Supplementary Material.

% FIG posterior
%% generated with posterior-plot.ipynb
\begin{figure}[h]
  \centering
\includegraphics[width=0.8\textwidth]{posterior.pdf}
  \caption{
  \textbf{Posterior distribution of model parameters.}
On the diagonal, the marginal posterior distribution of each model parameter. 
Below the diagonal, the joint posterior distribution of pairs of model parameters (dark purple and bright yellow for low and high density, respectively). Red markers and orange lines for the joint MAP estimate (which may differ from the marginal MAP, as the marginal distribution integrates over all other parameters).
} 
  \label{fig:posterior}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%

\paragraph{Model comparison and goodness-of-fit.}

% Fig model comparison 
%% generated with with-aneuploidy_vs_no_aneuploidy.ipynb
\begin{figure}[h!]
  \begin{subfigure}{0.5\textwidth}
      \centering
      \includegraphics[width=\textwidth]{fixation-plot-a.pdf}      
      \label{fig:fit}
  \end{subfigure}
  \begin{subfigure}{0.5\textwidth}
      \centering
      \includegraphics[width=\textwidth]{fixation-plot-b.pdf}      
      \label{fig:fit-cumulative}
  \end{subfigure}
  \caption{
    \textbf{Model fit with and without aneuploidy.}
    The distribution of time to fixation of \eumt\ (i.e., adaptation time) in $10,000$ simulations using MAP parameters of the model with beneficial aneuploidy (blue; $\delta>0, \; w_{\euwt}<w_{\anwt}<w_{\anmt}<w_{\eumt}$) compared to alternative models: a model with the same parameter values but without aneuploidy (gray, $\delta=0$, concentrated at $t=450$); a model fitted to the data assuming no aneuploidy (green, $\delta=0$); a model fitted to the data assuming neutral aneuploidy (yellow, $\delta>0, \; w_{\anwt}=w_{\euwt}, \; w_{\anmt}=w_{\eumt}$); and a model with beneficial aneuploidy and an extended prior distribution (pink).
In the experiment by \citet{Yona2012}, one population lost aneuploidy by generation 1,700 and another by generation 2,350 (dashed lines) but not before generation 450.
Thus, the blue distribution has a better fit compared to the other distributions (the gray distribution has a particulary poor fit).
The MAP likelihood (\cref{eq:heatstress-likelihood}) is 0.84, 0.78, 0.67, and 0.14 for the models represented by blue, yellow, green, and pink distributions, respectively. 
\textbf{(A)} Histogram of the time to fixation of \eumt. The last bin contains all values equal or greater than 3,000.
\textbf{(B)} Cumulative distribution of the time to fixation. 
     }
  \label{fig:2n*-fixation}
\end{figure}

To assess the fit of our model to the data, we use posterior predictive checks, in which we simulate the frequency dynamics using MAP parameter estimates and compare them to the data.
Our model fits the data well: \eumt\ fixed in 63\% of simulations by generation 1,700 and in 100\% of simulations by generation 2,350~(\Cref{fig:2n*-fixation}).
 
However, a model without aneuploidy (where the aneuploidy rate is fixed at zero, $\delta=0$), fails to explain the experimental observations~(Figure~\ref{fig:2n*-fixation}). %% generated with MAP-and-hdi.ipynb
The estimated mutation rate without aneuploidy is $\mu=7.98\cdot10^{-9}\ [7.906\cdot10^{-9}-8.138\cdot10^{-9}]$, much lower compared to a model with aneuploidy.
The fitness of the mutant is also much lower at $w_{\eumt}=1.013\ [1.012-1.013]$.
This is because, without aneuploidy, a high mutation rate or fitness effect will lead to faster appearance and fixation of \eumt\ than in the experimental observations. 

We also checked a model in which aneuploidy occurs but is adaptively neutral compared to the wild-type, that is, $w_{\anwt} = w_{\euwt}$ and $w_{\anmt} = w_{\eumt}$ but $\delta>0$. This model fits the data better than the model with no aneuploidy (in which $\delta=0$), but worse than a model with positive selection for aneuploidy, in which $w_{\euwt}<w_{\anwt}<w_{\anmt}<w_{\eumt}$~(\Cref{fig:2n*-fixation}). 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Model predictions of genotype frequency dynamics.}

We simulated 50 replicate genotype frequency dynamics using the MAP estimate parameters. 
\Cref{fig:FA}A shows the simulated frequencies of the four genotypes (\euwt, \anwt, \anmt\ and \eumt), as well as the frequencies of \eumt\ cells that arose from either \anwt\ cells via a sequences of mutation and chromosome loss events (\eumtA), or directly from \euwt\ cells via a mutation event (\eumtM).
We find that \anmt\ never reaches substantial frequency as it is quickly replaced by \eumt\ in a process similar to \emph{stochastic tunneling}~\citep{Iwasa2004,Komarova2003}.

To test the hypothesis that aneuploidy facilitates adaptation, we estimated $F_A$, the expected frequency of \eumt\ that arose from \anwt, computed as the average frequency of such \eumtA\ cells at the end of simulations using the MAP estimate parameters.
Surprisingly, we observe that the majority of \eumt\ cells are \eumtM, a product of a direct mutation in \euwt\ cells, rather than descending from \anwt\ cells ($F_A^{MAP} = 0.106$, average end point of 50 purple lines in \Cref{fig:FA}A). 
This is despite the fact that the \anwt\ genotype reaches high frequencies in the population (at least 0.98, \Cref{fig:FA}A).

This result is not unique to the MAP parameter estimate. 
We simulated genotype frequency dynamics using parameter samples from the posterior distribution, and computed the posterior distribution of $F_A$ (\Cref{fig:FA}B). 
The posterior mode $F_A$ was just 0.147 [0.0154-0.370 95\% CI] and only in 489 of 100,000 posterior samples (0.489\%) $F_A$ was  larger than 0.5 (see Supporting Material for results when transitions to less-fit genotypes are allowed, such as \eumt\ to \anmt).  
Thus, if we sample a random cell from the evolved \eumt\ population, it is more likely to have descended directly from an euploid cell than from an aneuploid cell. 
The probability of \eumt\ descending from \anwt\ ($F_A$) increases with the aneuploidy rate, $\delta$, and decreases with both the population size $N$ and the mutation rate, $\mu$ (\Cref{fig:FA}C,D). In some cases it can also be affected by the fitness parameters (Figure S10). 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Fig dynamics
\begin{figure}[p]
      \centering
      \includegraphics[width=0.8\textwidth]{FA.pdf}      
  \caption{
    \textbf{Predicted frequency of aneuploid-descended cells.}     
    \textbf{(A)} Posterior predicted genotype frequencies over time, including the source of \eumt: \eumtA\ arose from \anwt, whereas \eumtM\ arose directly from \euwt. Colored curves are 50 simulations using the MAP estimate parameters. Black dashed curves are the expected genotype frequencies without genetic drift (from a deterministic model). 
     See Figure S9 for log-log scale, in which the sequence of events is easier to observe.
    \textbf{(B)} Posterior distribution of $F_A$, the expected frequency of \eumt\ cells descended from \anwt\ cells, computed as the average frequency at the end of 100 simulations for 100,000 samples from the parameter posterior distribution.
    Solid and dashed lines show the mode and 95\% CI.
	\textbf{(C)} $F_A$ values (color coded) from panel B, with their corresponding mutation rate $\mu$ on x-axis and aneuploidy rate $\delta$ on the y-axis.
	Yellow star shows the MAP estimate. See also Figure S10.
	\textbf{(D)} $F_A$ as a function of the population size ($N$, bottom x-axis) and the beneficial mutation rate ($\mu$, top x-axis) in posterior predictions with MAP parameters. 
	Markers show $F_A$ in 250 simulations per population size or mutation rate value.
	Error bars show mean $F_A$ with 95\% CI (bootstrap, $n=10,000$). Blue and red bars for varying population size and mutation rate, respectively.
	Vertical dashed line for population size in the experiment, $6.425\cdot10^6$, and the MAP mutation rate, $2.965\cdot10^{-6}$. Horizontal line for $F_A^{MAP}=0.106$. 
	\textbf{(E)} Population mean fitness in a model without drift using MAP estimate parameters. Solid lines for mean fitness with aneuploidy ($\delta>0$), where the population reaches adaptation (mean fitness at 99.99\% of maximum value) at generation 1,802. Dashed lines for mean fitness without aneuploidy ($\delta=0$), where the population adapts much earlier, at generation 535.
     }
  \label{fig:FA}
\end{figure}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\paragraph{Genetic instability in aneuploid cells.}
It has been suggested that aneuploidy increases genomic instability: \citet{Sheltzer2011b} have demonstrated a fold increase of between 2.2 and 7.1 in the mutation rate of disomic yeast (rather than trisomic yeast, the focus of our analysis).
Therefore, we inferred model parameters under the assumption that the mutation rate increases in aneuploid cells by a factor $\tau$ = 1, 33/32 (due to an additional chromosome), 2, 5, 10, or 100 (due to genetic instability).
We found that the posterior distribution was similar for $\tau=$1, 33/32, 2, and 5 (Figure S4). Furthermore, we computed the WAIC, a criterion for model selection (Methods). The WAIC values were similar for all $\tau$ values (Table S1).

%% generated with MAP-and-hdi.ipynb
Assuming a strong increase of the mutation rate in aneuploid cells, i.e. $\tau=100$, the inferred a mutation rate was $\mu=4.094\cdot10^{-7}\ [6.252\cdot10^{-8}-6.046\cdot10^{-7}]$), and the inferred aneuploidy rate that was  $\delta=0.744\cdot10^{-3}\ [0.506\cdot10^{-3}-1.827\cdot10^{-3}]$. 
Compared to inference made assuming no effect of aneuploidy on the mutation rate, these rates were about 7-8-fold and 2-3-fold lower for $\mu$ and $\delta$, respectively.
Assuming $\tau=10$, the inferred a mutation rate was only slightly lower compared to $\tau=1$ ($\mu=1.67\cdot10^{-6}\ [2.836\cdot10^{-8}-2.245\cdot10^{-6}]$). 

Therefore, we do not find evidence of an increase in mutation rate in aneuploid cells. This may be because, unless the increase is strong ($\tau \ge 10$), it does not seem to affect our inference; or because Chromosome III is one of the smallest chromosomes \citep{Gilchrist2019}.
We also checked the differences in genotype frequency dynamics for different $\tau$ values. We observe $\tau=100$ could be distinguished if accurate data was available for the waiting time until the frequency of \euwt\ to decrease below 95\%~(Figure S5A) or for waiting time for the frequency of \anwt\ to either reach or go below 95\%~(Figure S5B).

Similarly, we did not find evidence for an increase in the rate of chromosome loss in aneuploid cells~\citep{Sheltzer2011b}, probably due to lack of statistical power.
Nevertheless, increasing the rate of chromosome loss (transitions from \anmt\ to \eumt) without increasing the rate of chromosome gain (transitions from \euwt\ to \anwt) increases $F_A$ (Figure S11B), but not to the same extent as increasing the rate of chromosome gain (Figure S10).
In contrast, increasing the mutation rate in aneuploid cells can have a marked effect on the dynamics: when using the MAP parameter estimates, $F_A$ increases from  0.1 to 0.52 when the mutation rate in aneuploid cells increases 10-fold (Figure S11C).


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Discussion
\section*{Discussion}

In a study on the role of chromosome duplication in adaptive evolution, 
\citet{Yona2012} found that a Chromosome III trisomy was acquired by \yeast populations evolving under heat stress, only to be later replaced by euploid mutant cells that carry "refined" solutions to the stress. 
Additionally, such a replacement also occurred when they initiated evolutionary experiments with a population in which all cells carry a Chromosome III trisomy.
They hypothesized that aneuploidy is a ``useful yet short-lived intermediate that facilitates further adaptation'', suggesting that the euploid mutant cells evolved by heat-resistance mutations in aneuploid cells followed by reversion of trisomy due to a chromosome loss event. 

We developed an evolutionary genetic model of adaptive evolution by aneuploidy and mutation (\Cref{fig:models}), fitted it to the experimental results of \citet{Yona2012}, and used it to predict the genotype frequency dynamics.
The model predicted that only about 10-15\% of the evolved euploid population descended from aneuploid cells by acquiring a mutation and losing the extra chromosome--that is, the majority of the euploid population are not descended from aneuploid cells, but rather are direct descendants of the ancestral wild-type population (\Cref{fig:FA}).

This happens despite aneuploidy reaching a high frequency in the population (>95\%). 
Conventional wisdom might suggest that once the aneuploid genotype \anwt\ reaches high frequency, it will have a better chance at producing "refined" solutions via mutations, and its descendants will come to dominate the population: the frequency of \eumtA\ (which arises from \anmt) will be higher than the frequency of \eumtM\ (which arises directly from \euwt).

So how does \eumtM\ prevail?
Initially, the supply rates of \anwt\ and \eumtM\ are $N \delta \approx 11,000$ and $N \mu \approx 19$, respectively (assuming MAP parameter estimates). 
Therefore, both genotypes are expected to appear immediately at the beginning of the experiment (Figure S9).
However, \anwt\ appears at a much higher frequency as $\delta \gg \mu$ by 2-3 orders of magnitude.
After they first appear, \eumtM\ has higher fitness.
But as long as the frequency of \euwt\ is high, the supply rate of \anwt\ is higher than that of \eumtM, again due to $\delta \gg \mu$. 
However, supply rates of both genotypes decreases with the frequency of \euwt.
Therefore, when the latter decreases, mainly due to the increase in the frequency of \anwt, both supply rates diminish.
At this stage, the higher fitness of \eumtM\ comes into play and it starts to take over the population, which is mainly composed of \anwt.
For the aneuploid lineage to compete with the mutant lineage, it must produce \eumtA\ via a mutation followed by chromosome loss.
Although this is a stochastic process (due to drift), our results show that the time until \eumtA\ reaches a frequency of ~0.1\% is roughly 450 generations, without much variation (intersection of purple lines and vertical dashed line in Figure S9.
However, by that time \eumtM\ is already at a roughly 10-fold higher frequency (1.86\%), and since both mutants have the same fitness, their relative frequency remains roughly the same until the end of the experiment. 

% mutation supply
\paragraph{Predictions for small populations and low mutation rates.}
We examined the effect of the population size, $N$, and the beneficial mutation rate, $\mu$, on the frequency of \anwt\ descendants in the evolved population, $F_A$.
We found that $F_A$ is expected to decrease as the population size or mutation rate increase (\Cref{fig:FA}D), ranging from >90\% when the population size is 10,000 or the mutation rate is $6\cdot10^{-9}$, to about 10\% when the population size is above 1,000,000 (less than the experimental population size, which was 6,425,000) or the mutation rate is above $2\cdot10^{-6}$ (less than the inferred mutation rate, which is $2.965\cdot10^{-6}$). 
Thus, our model provides a testable prediction: if the experiment was repeated under a lower population size (via stronger daily dilutions or in a smaller volume) or a lower mutation rate (via a non-mutagenic stress or stress with a smaller target size such as drug resistance), then the fraction of the population descending from aneuploid cells would be much higher.

% mean fitness
\paragraph{Aneuploidy delays rather than facilitates adaptation.}
An additional interesting result of our study is that aneuploidy increases, rather than decreases, the adaptation time (\Cref{fig:FA}E). 
This happens despite the fact that the mean fitness initially increases faster in the presence of aneuploidy (\Cref{fig:FA}E). 
Aneuploidy increases adaptation time because once \anwt\ is common, selection for the mutant strain (\anmt\ or \eumt) is weaker compared to when \eumt\ competes directly with \euwt.
This is an interesting example of clonal interference~\citep{Good2012} but between fast and slow mutational processes~\citep{Kronholm2016}.

% parameter estimates
\paragraph{Rate and fitness effect of aneuploidy and mutation.}
We inferred the rates of aneuploidy and mutation and their effects on fitness. 
We estimate that the aneuploidy rate (i.e., number of chromosome gains per generation) is $1.7 \cdot 10^{-3}$, higher than a previous estimate of $6.7 \cdot 10^{-6}$ \citep{Zhu2016}. This may be due to genetic instability caused by heat stress~\citep{Chen2012a}, but we note that there is a general scarcity of empirical data on aneuploidy rates.
In addition, we did not find evidence for increased mutation rates in aneuploid cells. 
Previous empirical studies have suggested that genetic instability (e.g., elevated mutation rates) in aneuploid cells is due to stress associated with the aneuploid state~\citep{Bouchonville2009, Chen2012b, Zhu2012, Ippolito2021b}.
However, in the experiment of \citet{Yona2012}, both the wild-type and the aneuploid were under heat stress, which may explain why we didn't find evidence for an increased mutation rate specifically in aneuploid cells.

% haploids
\paragraph{Effect of ploidy.}
The evolutionary dynamics may change in haploid yeast, in which aneuploidy results in a second, rather than third, chromosome copy. 
For example, it has been demonstrated that drug resistance mainly evolves via recessive mutations and aneuploidy in haploid yeast~\citep{Soncini2020}, whereas in diploid yeast it evolves via dominant mutations, aneuploidy, and gene/segmental duplications~\citep{Barney2021}.
Thus, the second chromosome copy of disomic yeast may facilitate further adaptation via duplications, rearrangements, and increased mutational tolerance~\citep{Avecilla2023}, while decreasing the chance for adaptation via recessive mutations. 
Future models and experiments can consider how ploidy and other genomic contexts affect the role of aneuploidy in adaptive evolution.

% Conclusions
\paragraph{Conclusions.}
Here, we tested the hypothesis that aneuploid cells are an evolutionary ``stepping stone'', or adaptive intermediate, between wild-type euploid cells and mutant euploid cells in the evolutionary experiment of~\citet{Yona2012}. 
Our results suggest that, although it seems the population goes from euploid to aneuploid and back, this is not the case at the individual level. We estimate that only about 10-15\% of the euploid cells descended from aneuploid cells, whereas the rest are direct descendants of the wild-type euploid cells.
Thus, aneuploidy can delay, rather than accelerate, adaptation, and cells that become aneuploid may leave less descendants than cells that remain euploid. 
This surprising result reinforces the importance of mathematical models when interpreting evolutionary dynamics.
Moreover, our study emphasizes the unintuitive outcomes of clonal interference  between mechanisms for generation of variation that differ in their rate of formation and distribution of fitness effects, including mutation, copy number variation, horizontal gene transfer, and epigenetic modifications. 


%%%%%%%%%%%%%%%%%%%%%%%%
% Models and Methods
\section*{Models and Methods}

%%%%%%%%%%%%%%%%%%%%%%%%
\paragraph{Evolutionary genetic model.}
We model the evolution of a population of cells using a Wright-Fisher model~\citep{Otto2007}, assuming a constant effective population size $N$, non-overlapping generations, and including the effects of natural selection, genetic drift, aneuploidy, and mutation. 
We focus on beneficial genetic modifications, neglecting the effects of deleterious and neutral mutations or karyotypic changes.
The model allows for a single aneuploid karyotype (e.g., Chromosome III duplication) and a single mutation to accumulate in the genotype.
Thus, the model follows four genotypes~(\Cref{fig:models}): euploid wild-type, \euwt, the initial genotype; 
euploid mutant, \eumt, with the standard karyotype and a single beneficial mutation; 
aneuploid wild-type, \anwt, with an extra chromosome, i.e., following chromosome duplication; and
aneuploid mutant, \anmt, with and extra chromosome and a beneficial mutation. 

Transitions between the genotypes occur as follows~(\Cref{fig:models}): Beneficial mutations from \euwt\; to \eumt\; and from \anwt\; to \anmt\; occur with probability $\mu$, the mutation rate. We neglect back-mutations (i.e., from \eumt\; to \euwt\; and from \anmt\; to \anwt).
Aneuploidy is formed by chromosome mis-segregation, so that cells transition from \euwt\; to \anwt\; and from \anmt\ to \eumt\ with probability $\delta$, the aneuploidy rate. That is, we assume chromosomes are gained and lost at the same rate, and we neglect events that form a less-fit genotype (i.e., \anwt\; to \euwt\; and \eumt\; to \anmt). A model that assumes an increased rate of chromosome loss in aneuploid cells (as in \citet{Sheltzer2011b}) did not perform well, probably due to lack of statistical power, and was abandoned.

In the experiment by \citet{Yona2012}, the population was grown every day from $1.6 \cdot 10^6$ cells until reaching stationary phase and then diluted 1:120.
Thus, we set the population size to $N=6.425 \cdot 10^6$, the harmonic mean of $\{2^k \cdot 1.6 \cdot 10^6\}_{k=0}^{7}$~\citep{Crow1970}.
The initial population has $N$ cells with genotype \euwt. 
The effect of natural selection on the frequency $f_i$ of genotype $i = 2n, 2n+1, 2n+1^*, \text{or } 2n^*$ is given by
    \begin{equation} \label{eq:selection-single} 
      f^s_i = \frac{f_i w_i}{\bar{w}} \;,
    \end{equation}
where $w_i$ is the fitness of genotype $i$ and $\bar{w} = \sum_{j}{f_j w_j}$ is the population mean fitness.
The effect of mutation and aneuploidy on genotype frequencies is given by
    \begin{equation} \label{eq:mutation-aneuploidy-single}
    \begin{aligned}
      &f^m_{2n} &=&\; (1 - \delta - \mu) f^s_{2n}  \;,\\
      &f^m_{2n+1} &=&\; \delta f^s_{2n} + (1 - \mu) f^s_{2n+1}  \;,\\
      &f^m_{2n+1^*} &=&\; \mu f^s_{2n+1} + (1-\delta) f^s_{2n+1^*}  \;,\\
      &f^m_{2n^*} &=&\; \mu f^s_{2n} + \delta f^s_{2n+1^*} + f^s_{2n^*}  \;.
    \end{aligned}
    \end{equation}
Finally, random genetic drift is modeled using a multinomial distribution~\citep{Otto2007},
    \begin{equation} \label{eq:drift-single}
      \vec{f'} \sim \frac{1}{N} \cdot \mathit{Mult}(N,\ \vec{f^m}) \;,
    \end{equation}
where $\vec{f^m}=(f^m_{2n}\ ,\ f^m_{2n+1}\ ,\ f^m_{2n+1^*}\ ,\ f^m_{2n^*})$ are the frequencies of the genotypes after mutation and aneuploidy, $\vec{f'}$ are the genotype frequencies in the next generation, and $Mult(N,\ \vec{f})$ is a multinomial distribution parameterized by the population size $N$ and the genotype frequencies $\vec{f}$.
Overall, the change in genotype frequencies from one generation to the next is given by the transformation $f_i \to f'_i$.

\paragraph{Empirical data for model inference.}

We use the results of evolutionary experiments reported by \citet{Yona2012}.
In their heat-stress experiment, four populations of \yeast evolved under 39\degree C. 
Aneuploidy fixed (frequency >95\%) in all four population in the first 450 generations. 
Hereafter, fixation or elimination of a genotype by generation $t$ means that more than 95\% or less than 5\% of the population carry the genotype at generation $t$, and possibly earlier. 
In the original analysis of \citet{Yona2012}, samples were routinely extracted from the evolving populations and tested for indication of heat-shock tolerance. The first generation in which such indication was found was generation 200. Therefore, we determine that aneuploidy did not reach high frequency before generation 200.
The experiment continued with two populations, in which aneuploidy was eliminated by generation 1,700 and 2,350 while still under the same conditions of elevated heat (39\degree C).

\paragraph{Likelihood function.} 
Because our model, just like the Wright-Fisher model, is non-linear and stochastic, computing the distribution of fixation time $T(g)$ of genotype $g$ for use in the likelihood function is intractable (it is even hard to use a diffusion-equation approximation due to the model having multiple genotypes, rather than just two).
We overcome this problem by approximating the likelihood using simulations. We simulate 1,000 experiments per parameter vector $\theta = (\mu, \delta, s, b, c)$, resulting in a set of simulated observations $\tilde{\vec X} = \{\tilde{X}_i\}_{i=1}^{1000}$. We then compute the approximate likelihood,
\begin{equation}\begin{aligned}
\label{eq:heatstress-likelihood}
\likelihood(\theta) = &\ P^4(200 \le T(2n+1) \le 450) \cdot 
	\Big[1 - \\
	&	P_{\tilde{\vec X}}^4\big(!\{T(2n^*)<1700\} \mid 200 \le T(2n+1) \le 450\big)- \\
	&	P_{\tilde{\vec X}}^4\big(!\{1700 < T(2n^*) < 2350\} \mid 200 \le T(2n+1) \le 450\big)+ \\
	&	P_{\tilde{\vec X}}^4\big(!\{T(2n^*)<1700\} \land !\{1700 < T(2n^*) < 2350\} \mid 200 \le T(2n+1) \le 450\big) 
	\Big]\;,
\end{aligned}\end{equation}
where $!\{\ldots\}$ is the "logical not" operator, $P^4(\ldots)$ is the 4th power of $P(\ldots)$, and all probabilities $P_{\tilde{\vec X}}(\ldots)$ are approximated from the results of the simulations $\tilde{\vec X}$. For example, $P_{\tilde{\vec X}}\big(!\{T(2n^*)<1700\} \mid 200 \le T(2n+1) \le 450\big)$ is approximated by taking simulations in which \anwt\; fixed (reached >95\%) before generation 450 but not before generation 200, and computing the fraction of such simulations in which \eumt\; did not fix by generation 1,700, and hence aneuploidy did not extinct (reach <5\%) before generation 1,700.
Figure S1 compares results with less and more simulated experiments, demonstrating that 1,000 simulations are likely sufficient.
 
For a model without aneuploidy (that is, when the aneuploidy rate is fixed at zero, $\delta=0$), we disregard the increased expression in Chromosome III and the growth advantage measured in generation 450, and focus on the growth advantage measured in later generations, presumably due to a beneficial mutation. 
Therefore, the likelihood is approximated by
\begin{equation}\begin{aligned}
\label{eq:heatstress-noaneuploidy-likelihood}
\likelihood_{!}(\theta) = &\ 
	1 - 
	P_{\tilde{\vec X}}^4\big(!\{T(2n^*)<1700\}\big) - \\
&	P_{\tilde{\vec X}}^4\big(!\{1700 < T(2n^*) < 2350\}\big) + \\
&	P_{\tilde{\vec X}}^4\big(!\{T(2n^*)<1700\} \land !\{1700 < T(2n^*) < 2350\}\big)
\;.
\end{aligned}\end{equation}

\paragraph{Parameter inference.} To infer model parameters, we use approximate Bayesian computation with a sequential Monte-Carlo scheme, or ABC-SMC~\citep{Sisson2009}, implemented in the \texttt{pyABC} Python package~\citep[\href{https://pyabc.readthedocs.io}{pyabc.readthedocs.io}]{Klinger2018}.
This approach uses numerical stochastic simulations of the model to infer a posterior distribution over the model parameters. It is a method of likelihood-free, simulation-based inference~\citep{Cranmer2020}, that is, for estimating a posterior distribution when a likelihood function cannot be directly computed. It is therefore suitable in our case, in which the likelihood function can only be approximated from simulations, and cannot be directly computed. 

The ABC-SMC algorithm employs sequential importance sampling over multiple iterations~\citep{Toni2009, Klinger2017, Syga2021}.
In iteration $t$ of the algorithm, a set of parameter vectors, $\{\theta_{i,t}\}_{i=1}^{n_t}$, also called \emph{particles}, are constructed in the following way.
A proposal particle, $\theta^*$, is sampled from a proposal distribution, and is either accepted or rejected, until $n_t$ particles are accepted.
The number of particles, $n_t$, is adapted at every iteration $t$ using the adaptive population strategy~\citep[\href{https://pyabc.readthedocs.io}{pyabc.readthedocs.io}]{Klinger2018}.
For $t=0$, the proposal particle is sampled from the prior distribution, $p(\theta)$.
For $t>0$, the proposal particle is sampled from the particles accepted in the previous iteration, $\{\theta_{i,t-1}\}_{i=1}^{n_{t-1}}$, each with a probability relative to its weight $W_{t-1}(\theta_{i,t-1})$ (see below). The proposal particle is then perturbed using a kernel perturbation kernel, $K_t(\theta^* \mid \theta)$ where $\theta$ is the sample from the previous iteration.
Then, a set of synthetic observations $\tilde{\vec X}^*$ is simulated, and the proposal particle $\theta^*$ is accepted if its approximate likelihood (\cref{eq:heatstress-likelihood}) is high enough, $\likelihood(\theta^*)>1-\epsilon_t$ (or more commonly, if $1-\likelihood(\theta^*) < \epsilon_t$), where $\epsilon_t>0$ is the \emph{acceptance threshold}, as higher values of $\epsilon_t$ allow more particles to be accepted. 
The acceptance threshold $\epsilon_t$ is chosen as the median of the $1-\likelihood(\theta)$ of the particles accepted in the previous iteration, $t-1$, and $\epsilon_0=0.01$. 
For each accepted particle $\theta_{i,t}$ a weight $W_t(\theta_{i,t})$ is assigned: for $t=0$, $W_0(\theta_{i,0})=1$, and for $t>0$, 
$W_t(\theta_{i,t}) = p(\theta_{i,t}) / \sum_{i=1}^{n_{t-1}}{W_{t-1}(\theta_{i,t-1}) K_t(\theta_{i,t}, \theta_{i,t-1})}$, where $p(\theta)$ is the prior density of $\theta$ and $K_t(\theta', \theta)$ is the probability of a perturbation from $\theta$ to $\theta'$.
$K_t(\theta' \mid \theta)$ is a multivariate normal distribution, fitted at iteration $t$ to the particles from the previous iteration, \{$\theta_{i,t-1}\}_{i=1}{n_{t-1}}$, and their weights, $\{W(\theta_{i,t-1})\}_{i=1}^{n_{t-1}}$.

Acceptance is determined according to the approximate likelihood~(\cref{eq:heatstress-likelihood}), which has a maximum value of $\likelihood_{max}=0.875$ (giving a minimal value of $\epsilon_{min}=0.125$). We terminated the inference iterations when the change in $\epsilon$ value from one iteration to the next was small.
With our standard prior and model, we reached $\epsilon=0.13$ (or $\likelihood=0.87$) after six iterations, with $n_6=982$ accepted parameter vectors and effective sample size ESS=651 (Figure S2). Running the inference algorithm with different initialization seeds and less or more simulations for approximating the likelihood produced similar posterior distributions~(Figure S1). 

After producing a set of weighted particles from the the posterior distribution using the above ABC-SMC algorithm, we approximate the posterior using kernel density estimation (KDE) with Gaussian kernels. We truncate the estimated posterior to avoid positive posterior density for values with zero prior density. The MAP (maximum a posteriori) estimate is computed as the the maximum of the estimated joint posterior density. We then draw $5,000,000$ samples from the posterior distribution to compute the HDI (highest density interval) and draw $50,000$ samples to visualize the posterior distribution with histograms.

\paragraph{Model comparison.} 
We examine several versions of our evolutionary models, e.g. without aneuploidy or with increased mutation rate in aneuploid cells, as well as several different prior distributions (see below).
To compare these, we plot posterior predictions: for each model we execute $10,000$ simulations using the MAP parameter estimates and plot the distributions of time to fixation of \eumt, one of key properties of the model likelihood. These plots visualize the fit of each model to the data. 
Also, for similar models we plot the marginal and joint posterior distributions of the parameters; if these are similar, we consider the models interchangeable. We validate this by comparing HDI (highest density interval) of posterior distributions.

Where posterior plots are very similar and the number of parameters is the same, we use WAIC, or the widely applicable information criterion~\citep{gelman2013bayesian}, defined as
\begin{equation} \label{eq:WAIC}
\begin{aligned}
\mathit{WAIC}(\theta) &\ =\ 
-2\log\mathbb{E}[\likelihood(\theta)]\ +\ 2\mathbb{V}[\log\likelihood(\theta)]
\end{aligned}
\end{equation}
where $\theta$ is a parameter vector, and $\mathbb{E}[\cdot]$ and $\mathbb{V}[\cdot]$ are the expectation and variance taken over the posterior distribution, which in practice are approximated using 50,000 samples from the posterior KDE. We validated that upon resampling WAIC values do not significantly change and that differences in WAIC between models are preserved.
WAIC values are scaled as a deviance measure: lower values imply higher predictive accuracy.
 
\paragraph{Prior distributions.} \label{par:prior}
We used informative prior distributions for $w_{\anwt}$, $w_{\anmt}$ and $w_{\eumt}$ (we set $w_{2n}=1$), which we estimated from growth curves data from mono-culture growth experiments previously reported by \citet[Figs. 3C, 4A, and S2]{Yona2012}.
We used \texttt{Curveball}, a method for predicting results of competition experiments from growth curve data~\citep[\href{https://curveball.yoavram.com}{curveball.yoavram.com}]{Ram2019}. Briefly, \texttt{Curveball} takes growth curves of two strains growing separately in mono-culture and predicts how they would grow in a mixed culture, that is, it predicts the results of a competition assay.
From these predictions, relative fitness values can be computed. Because \texttt{Curveball} uses a maximum-likelihood approach to estimate model parameters, we were able to estimate a distribution of relative fitness values to be used as a prior distribution by sampling 10,000 samples from a truncated multivariate normal distribution defined by the maximum-likelihood covariance matrix~(Figure S3).

We used growth curves of \euwt\ and \anwt\ in 39\degree C to estimate an informative prior distribution for $w_{\anwt}$~(Figure S3D, assuming $w_{\euwt}=1$).
In this prior distribution, we used the same prior for $w_{\anmt}$ and $w_{\eumt}$. 
To increase computational efficiency, we also assumed $w_\eumt>w_\anmt>w_\anwt>w_\euwt$; running the inference without this assumption produced similar results.
See \emph{supporting material} for an extended informative prior distribution that uses growth curves of \eumt\ and \anwt\ growing in 39\degree C; this prior distribution proved to be less useful.

As a control, we tested an uninformative uniform prior with $\mathit{U}(1,6)$, for (i) all $w_{\anwt}$, $w_{\anmt}$, $w_{\eumt}$, or (ii) only for $w_{\anmt}$, $w_{\eumt}$, using the above informative prior for $w_{\anwt}$. In these cases the inference algorithm failed to converge.
 
For the mutation rate, $\mu$, and aneuploidy rate, $\delta$, we used uninformative uniform priors, $\mu \sim \mathit{U}(10^{-9},10^{-5})$ and $\delta \sim \mathit{U}(10^{-6},10^{-2})$. A wider mutation rate prior, $\mu \sim \mathit{U}(10^{-9},10^{-3})$, produced similar results.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

% Acknowledgements
{\small
\section*{Acknowledgements}
We thank Lilach Hadany, Judith Berman, David Gresham, Shay Covo, Martin Kupiec, Uri Obolski, Daniel Weissman, and Tal Simon for discussions and comments.
This work was supported in part by 
the Israel Science Foundation~(ISF, YR 552/19),
the US--Israel Binational Science Foundation~(BSF, YR 2021276),
Minerva Center for Live Emulation of Evolution in the Lab~(YR, YP),
Minerva Stiftung short-term research grant~(MP),
the Burroughs Wellcome Fund (AS),
and the Jane Coffin Childs Memorial Fund (PVZ).
}

\bibliographystyle{agsm}
\bibliography{ms.bib}


\end{document}  